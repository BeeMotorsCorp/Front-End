<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Cadastro</title>
  <!-- Importa Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    /* Estilo para mensagens de erro */
    .mensagem-erro {
      color: #dc3545;
      margin-top: 10px;
      text-align: center;
    }
  </style>
</head>
<body class="bg-light d-flex justify-content-center align-items-center vh-100">
  <!-- Container principal do formulário -->
  <div class="card p-4 shadow" style="width: 320px;">
    <h4 class="mb-4 text-center">Cadastre-se</h4>

    <!-- Formulário de cadastro -->
    <form id="cadastroForm">
      <!-- Campo Nome -->
      <div class="mb-3">
        <label for="nome" class="form-label">Nome</label>
        <input type="text" class="form-control" id="nome" placeholder="Digite seu nome" required>
      </div>

      <!-- Campo Sobrenome -->
      <div class="mb-3">
        <label for="sobrenome" class="form-label">Sobrenome</label>
        <input type="text" class="form-control" id="sobrenome" placeholder="Digite seu sobrenome" required>
      </div>

      <!-- Campo CPF -->
      <div class="mb-3">
        <label for="cpf" class="form-label">CPF</label>
        <input type="text" class="form-control" id="cpf" placeholder="000.000.000-00" required>
      </div>

      <!-- Campo Usuário -->
      <div class="mb-3">
        <label for="usuario" class="form-label">Usuário</label>
        <input type="text" class="form-control" id="usuario" placeholder="Crie seu usuário" required>
      </div>

      <!-- Campo Senha -->
      <div class="mb-3">
        <label for="senha" class="form-label">Senha</label>
        <input type="password" class="form-control" id="senha" placeholder="Crie sua senha" required>
      </div>

      <!-- Botão de submissão -->
      <button type="submit" class="btn btn-success w-100">Cadastrar</button>
    </form>

    <!-- Link para login -->
    <p class="mt-3 text-center" style="font-size: 0.9rem;">
      Já tem conta? <a href="login.html">Faça login</a>.
    </p>
  </div>

  <script>
    // Event listener para o formulário de cadastro
    document.getElementById("cadastroForm").addEventListener("submit", async function(e) {
      e.preventDefault();

      try {
        // Envia dados para o endpoint de cadastro
        const resposta = await fetch("Back-End/gunPHP/cadastrar.php", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            nome: document.getElementById("nome").value,
            sobrenome: document.getElementById("sobrenome").value,
            cpf: document.getElementById("cpf").value,
            usuario: document.getElementById("usuario").value,
            senha: document.getElementById("senha").value
          })
        });

        // Processa a resposta
        const resultado = await resposta.json();

        if (resultado.status === "ok") {
          alert("Cadastro realizado com sucesso!");
          window.location.href = "login.html";
        } else {
          // Exibe mensagem de erro
          const mensagemErro = document.createElement("div");
          mensagemErro.textContent = resultado.mensagem || "Erro no cadastro";
          mensagemErro.classList.add("mensagem-erro");
          
          // Remove mensagens antigas
          const mensagemAntiga = document.querySelector(".mensagem-erro");
          if (mensagemAntiga) mensagemAntiga.remove();
          
          // Adiciona nova mensagem
          document.getElementById("cadastroForm").appendChild(mensagemErro);
        }
      } catch (error) {
        console.error("Erro:", error);
        alert("Erro ao conectar com o servidor");
      }
    });
  </script>
</body>
</html>